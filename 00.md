
```bash
sudo timedatectl set-timezone America/Sao_Paulo
sudo nano /etc/udev/rules.d/10-network.rules
```

```ini
SUBSYSTEM=="net", ACTION=="add", ATTR{address}=="00:e0:4c:68:00:94", NAME="eth0"
```

```bash
sudo nano /etc/systemd/network/10-wired.network
```

```ini
[Match]
Name=eth0

[Network]
Address=192.168.1.99/24
Gateway=192.168.1.1
DNS=127.0.0.1
```

```bash
sudo rm /etc/resolv.conf
sudo nano /etc/resolv.conf
```

```conf
nameserver 127.0.0.1
```

```bash
sudo systemctl enable --now systemd-networkd
sudo systemctl disable --now networking
```

```bash
sudo apt install iptables -y
for pkg in docker.io docker-doc docker-compose podman-docker containerd runc; do sudo apt-get remove -y $pkg; done
sudo apt-get update
sudo apt-get install -y ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] \
  https://download.docker.com/linux/debian $(. /etc/os-release && echo \"$VERSION_CODENAME\") stable" \
  | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo curl -SL https://github.com/docker/compose/releases/download/v2.34.0/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
sudo ln -sf /usr/local/bin/docker-compose /usr/bin/docker-compose
docker-compose version
```

```bash
sudo apt install unbound -y
sudo wget https://www.internic.net/domain/named.root -qO /var/lib/unbound/root.hints
sudo nano /etc/unbound/unbound.conf.d/pi-hole.conf
```

```conf
server:
    interface: 127.0.0.1
    port: 5335
    do-ip4: yes
    do-udp: yes
    do-tcp: yes
    do-ip6: yes
    prefer-ip6: no
    harden-glue: yes
    harden-dnssec-stripped: yes
    use-caps-for-id: no
    prefetch: yes
    num-threads: 1
    so-rcvbuf: 1m
    edns-buffer-size: 1232
    private-address: 192.168.0.0/16
    private-address: 169.254.0.0/16
    private-address: 172.16.0.0/12
    private-address: 10.0.0.0/8
    private-address: fd00::/8
    private-address: fe80::/10
    private-address: 192.0.2.0/24
    private-address: 198.51.100.0/24
    private-address: 203.0.113.0/24
    private-address: 255.255.255.255/32
    private-address: 2001:db8::/32
```

```bash
sudo systemctl restart unbound
dig pi-hole.net @127.0.0.1 -p 5335
```

```bash
sudo mkdir -p /opt/pihole
sudo nano /opt/pihole/docker-compose.yml
```

```yaml
services:
  pihole:
    container_name: pihole
    image: pihole/pihole:latest
    network_mode: host
    environment:
      TZ: 'America/Sao_Paulo'
      WEBPASSWORD: ''
    volumes:
      - './etc-pihole:/etc/pihole'
      - './etc-dnsmasq.d:/etc/dnsmasq.d'
    cap_add:
      - NET_ADMIN
    restart: unless-stopped
```

```bash
cd /opt/pihole
sudo docker-compose up -d
```

```bash
sudo docker exec -it pihole pihole setpassword
```

```bash
sudo mkdir -p /opt/portainer
sudo nano /opt/portainer/docker-compose.yml
```

```yaml
services:
  portainer:
    image: portainer/portainer-ce:latest
    container_name: portainer
    restart: unless-stopped
    ports:
      - "9000:9000"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - portainer_data:/data

volumes:
  portainer_data:
```

```bash
cd /opt/portainer
sudo docker-compose up -d
```

```bash
sudo mkdir -p /home/homelab/music
```

```bash
sudo mkdir -p /opt/metube
sudo nano /opt/metube/docker-compose.yml
```

```yaml
services:
  metube:
    image: ghcr.io/alexta69/metube
    container_name: metube
    restart: unless-stopped
    ports:
      - "8081:8081"
    volumes:
      - /home/homelab/music:/downloads
```

```bash
cd /opt/metube
sudo docker-compose up -d
```

```bash
sudo mkdir -p /opt/navidrome
sudo nano /opt/navidrome/docker-compose.yml
```

```yaml
services:
  navidrome:
    image: deluan/navidrome:latest
    container_name: navidrome
    ports:
      - "4533:4533"
    restart: unless-stopped
    volumes:
      - "/opt/navidrome/data:/data"
      - "/home/homelab/music:/music:ro"
```

```bash
cd /opt/navidrome
sudo docker-compose up -d
```

```bash
sudo apt install -y icecast2
```

```bash
sudo mkdir -p /opt/liquidsoap
sudo nano /opt/liquidsoap/docker-compose.yml
```

```yaml
services:
  liquidsoap:
    image: savonet/liquidsoap:v2.3.2
    container_name: liquidsoap
    volumes:
      - ./radio.liq:/etc/liquidsoap/radio.liq
      - /home/homelab/music:/home/music
    restart: unless-stopped
    command: ["liquidsoap", "/etc/liquidsoap/radio.liq"]
    extra_hosts:
      - "host.docker.internal:host-gateway"
```

```bash
sudo nano /opt/liquidsoap/radio.liq
```

```liq
radio_playlist = playlist(mode="normal", reload_mode="watch", "/home/music")
crossfaded = crossfade(fade_in=2.0, fade_out=2.0, radio_playlist)
crossfaded = amplify(0.5, crossfaded)
radio = fallback(track_sensitive = false, [crossfaded, blank()])
output.icecast(%mp3,
  host = "host.docker.internal",
  port = 8000,
  password = "hackme",
  mount = "/radio.mp3",
  name = "homelab",
  description = "radio",
  genre = "music",
  url = "http://radio.azzor1337x.shop/radio.mp3",
  public = true,
  radio)
```

```bash
sudo systemctl enable icecast2
sudo systemctl start icecast2
cd /opt/liquidsoap
sudo docker-compose up -d
```

```bash
sudo mkdir -p /opt/blog
sudo nano /opt/blog/index.html
```

```html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>azzor1337x - Blog</title>
</head>
<body>
  <h1>azzor1337x</h1>
  <p>blog!</p>
</body>
</html>
```

```bash
sudo mkdir -p /opt/blog/homelab
sudo nano /opt/blog/homelab/index.html
```

```html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>azzor1337x - Homelab</title>
</head>
<body>
  <h1>azzor1337x</h1>
  <p>homelab!</p>
</body>
</html>
```

```bash
sudo nano /opt/blog/docker-compose.yml
```

```yaml
services:
  blog:
    image: nginx:alpine
    container_name: web_blog
    ports:
      - "8082:80"
    volumes:
      - .:/usr/share/nginx/html:ro
    restart: unless-stopped

  homelab:
    image: nginx:alpine
    container_name: web_homelab
    ports:
      - "8083:80"
    volumes:
      - ./homelab:/usr/share/nginx/html:ro
    restart: unless-stopped
```

```bash
cd /opt/blog
sudo docker-compose up -d
```

```bash
cd /opt/blog
sudo wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
sudo dpkg -i cloudflared-linux-amd64.deb
```

```bash
sudo cloudflared tunnel login
```

```bash
sudo cloudflared tunnel create blog
```

```bash
sudo nano /root/.cloudflared/config.yml
```

```yaml
tunnel: blog
credentials-file: /root/.cloudflared/<UUID>.json

ingress:
  - hostname: pihole.azzor1337x.shop
    service: http://127.0.0.1:80

  - hostname: music.azzor1337x.shop
    service: http://127.0.0.1:4533

  - hostname: radio.azzor1337x.shop
    service: http://127.0.0.1:8000

  - hostname: youtube.azzor1337x.shop
    service: http://127.0.0.1:8081

  - hostname: azzor1337x.shop
    service: http://127.0.0.1:8082

  - hostname: homelab.azzor1337x.shop
    service: http://127.0.0.1:8083

  - hostname: portainer.azzor1337x.shop
    service: http://127.0.0.1:9000

  - service: http_status:404
```

```bash
sudo cloudflared tunnel run blog
```

```bash
sudo cloudflared service install
```
